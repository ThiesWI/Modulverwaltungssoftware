# ?? STATUS-WORKFLOW IMPLEMENTIERUNG

## Vollständiger Lebenszyklus eines Moduls

---

## ?? **STATUS-DIAGRAMM**

```
???????????????????????????????????????????????????????????????
?                     MODUL-LEBENSZYKLUS                       ?
???????????????????????????????????????????????????????????????

    [NEUES MODUL ERSTELLEN]
            ?
    ?????????????????
    ?   ENTWURF     ? ? Start (Dozent erstellt Modul)
    ?????????????????
            ?
    Dozent klickt "Einreichen"
    Bestätigung: "Möchten Sie das Modul zur Koordination einreichen?"
    ? JA
            ?
    ???????????????????????????
    ? InPruefungKoordination  ? ? Koordination prüft
    ???????????????????????????
        ?                   ?
        ?                   ??? Koordination klickt "Kommentieren"
        ?                       Bestätigung: "Kommentar wird an Ersteller gesendet. Status ? Änderungsbedarf"
        ?                       ? JA
        ?                           ?
        ?                   ?????????????????????
        ?                   ? Aenderungsbedarf  ? ? Zurück an Dozent
        ?                   ?????????????????????
        ?                           ?
        ?                   Dozent überarbeitet & reicht erneut ein
        ?                           ?
        ?                   ???????????????????????????
        ?                   ? InPruefungKoordination  ?
        ?                   ???????????????????????????
        ?                           
        ??? Koordination klickt "Einreichen" (Weiterleiten)
            Bestätigung: "Modul an Gremium weiterleiten?"
            ? JA
                ?
        ???????????????????????
        ? InPruefungGremium   ? ? Gremium prüft
        ???????????????????????
            ?                   ?
            ?                   ??? Gremium klickt "Kommentieren"
            ?                       Bestätigung: "Kommentar wird an Ersteller gesendet. Status ? Änderungsbedarf"
            ?                       ? JA
            ?                           ?
            ?                   ?????????????????????
            ?                   ? Aenderungsbedarf  ? ? Zurück an Dozent
            ?                   ?????????????????????
            ?                           
            ??? Gremium klickt "Einreichen" (Freigeben)
                Bestätigung: "Modul wirklich freigeben?"
                ? JA
                    ?
            ?????????????????
            ?  FREIGEGEBEN  ? ? Offiziell veröffentlicht
            ?????????????????
```

---

## ?? **STATUS-ÜBERGÄNGE IM DETAIL**

### **1. ENTWURF ? InPruefungKoordination**

**Wer:** Dozent (Ersteller) oder Admin  
**Button:** "Einreichen"  
**Voraussetzung:** Status = Entwurf ODER Änderungsbedarf

#### **Ablauf:**

```
1. User klickt "Einreichen"

2. BESTÄTIGUNGS-DIALOG:
   ??????????????????????????????????????????????????????
   ? Möchten Sie das Modul 'Software Engineering I'     ?
   ? wirklich zur Koordination einreichen?              ?
   ?                                                    ?
   ? Das Modul wird zur Prüfung weitergeleitet und     ?
   ? Sie können es nicht mehr bearbeiten, bis es       ?
   ? freigegeben oder kommentiert wird.                ?
   ?                                                    ?
   ?         [Nein]              [Ja]                  ?
   ??????????????????????????????????????????????????????

3. Bei JA:
   - Status: Entwurf ? InPruefungKoordination
   - Benachrichtigung an: Koordination
   - Text: "{User} hat das Modul '{Modulname}' zur Prüfung eingereicht."

4. ERFOLGS-DIALOG:
   ??????????????????????????????????????????????????????
   ? Das Modul 'Software Engineering I' wurde          ?
   ? erfolgreich eingereicht und an die Koordination   ?
   ? weitergegeben.                                    ?
   ?                                                    ?
   ? Status: In Prüfung (Koordination)                ?
   ?                                                    ?
   ?                   [OK]                            ?
   ??????????????????????????????????????????????????????

5. Seite wird neu geladen
   - Status-Badge zeigt: "In Prüfung" (Orange)
   - Buttons aktualisieren sich automatisch
```

---

### **2. InPruefungKoordination ? InPruefungGremium**

**Wer:** Koordination oder Admin  
**Button:** "Einreichen" (= Weiterleiten)  
**Voraussetzung:** Status = InPruefungKoordination

#### **Ablauf:**

```
1. Koordination klickt "Einreichen"

2. BESTÄTIGUNGS-DIALOG:
   ??????????????????????????????????????????????????????
   ? Möchten Sie das Modul 'Software Engineering I'     ?
   ? wirklich an das Gremium weiterleiten?             ?
   ?                                                    ?
   ? Das Modul wird zur finalen Genehmigung an         ?
   ? das Gremium weitergeleitet.                       ?
   ?                                                    ?
   ?         [Nein]              [Ja]                  ?
   ??????????????????????????????????????????????????????

3. Bei JA:
   - Status: InPruefungKoordination ? InPruefungGremium
   - Benachrichtigung an: Gremium
   - Text: "{User} (Koordination) hat das Modul zur finalen Genehmigung weitergeleitet."

4. ERFOLGS-DIALOG:
   ??????????????????????????????????????????????????????
   ? Das Modul 'Software Engineering I' wurde          ?
   ? erfolgreich an das Gremium weitergeleitet.        ?
   ?                                                    ?
   ? Status: In Prüfung (Gremium)                      ?
   ?                                                    ?
   ?                   [OK]                            ?
   ??????????????????????????????????????????????????????

5. Seite wird neu geladen
   - Status-Badge zeigt: "Gremium" (Gold)
   - Modul verschwindet aus "Meine Projekte" der Koordination
   - Modul erscheint in "Meine Projekte" des Gremiums
```

---

### **3. InPruefungGremium ? Freigegeben**

**Wer:** Gremium oder Admin  
**Button:** "Einreichen" (= Freigeben)  
**Voraussetzung:** Status = InPruefungGremium

#### **Ablauf:**

```
1. Gremium klickt "Einreichen"

2. BESTÄTIGUNGS-DIALOG:
   ??????????????????????????????????????????????????????
   ? Möchten Sie das Modul 'Software Engineering I'     ?
   ? wirklich freigeben?                               ?
   ?                                                    ?
   ? Das Modul wird offiziell veröffentlicht und      ?
   ? kann von allen Benutzern eingesehen werden.       ?
   ?                                                    ?
   ?         [Nein]              [Ja]                  ?
   ??????????????????????????????????????????????????????

3. Bei JA:
   - Status: InPruefungGremium ? Freigegeben
   - Benachrichtigung an: Ersteller
   - Text: "Glückwunsch! Ihr Modul wurde freigegeben und ist jetzt offiziell veröffentlicht."

4. ERFOLGS-DIALOG:
   ??????????????????????????????????????????????????????
   ? Das Modul 'Software Engineering I' wurde          ?
   ? erfolgreich freigegeben und ist jetzt            ?
   ? offiziell veröffentlicht.                        ?
   ?                                                    ?
   ? Status: Freigegeben                               ?
   ?                                                    ?
   ?                   [OK]                            ?
   ??????????????????????????????????????????????????????

5. Seite wird neu geladen
   - Status-Badge zeigt: "Freigegeben" (Grün)
   - Modul erscheint für ALLE Benutzer auf StartPage
   - Buttons ausgegraut (nur Admin darf ändern)
```

---

### **4. KOMMENTIERUNG ? Aenderungsbedarf**

**Wer:** Koordination, Gremium oder Admin  
**Button:** "Kommentieren" ? "Kommentar Abschicken"  
**Voraussetzung:** 
- Koordination: Status = InPruefungKoordination
- Gremium: Status = InPruefungGremium

#### **Ablauf:**

```
1. User klickt "Kommentieren" in ModulView
   ? Navigation zu CommentView

2. User gibt Kommentare ein (mindestens 1)

3. User klickt "Kommentar Abschicken"

4. BESTÄTIGUNGS-DIALOG (Koordination):
   ??????????????????????????????????????????????????????
   ? Möchten Sie den Kommentar wirklich an den         ?
   ? Modulersteller weitergeben?                       ?
   ?                                                    ?
   ? Das Modul wird als 'Änderungsbedarf' markiert     ?
   ? und an den Ersteller zurückgegeben.               ?
   ?                                                    ?
   ? Anzahl Kommentare: 3                              ?
   ?                                                    ?
   ?         [Nein]              [Ja]                  ?
   ??????????????????????????????????????????????????????

5. Bei JA:
   - Kommentare werden gespeichert
   - Status: InPruefungKoordination ? Aenderungsbedarf
   - hatKommentar: true
   - Benachrichtigung an: Ersteller
   - Text: "{User} ({Rolle}) hat Ihr Modul kommentiert. Bitte überarbeiten Sie das Modul."

6. ERFOLGS-DIALOG (Koordination):
   ??????????????????????????????????????????????????????
   ? Der Kommentar wurde erfolgreich eingereicht.      ?
   ?                                                    ?
   ? Das Modul wurde an den Ersteller zurückgegeben    ?
   ? und hat jetzt den Status 'Änderungsbedarf'.       ?
   ?                                                    ?
   ?                   [OK]                            ?
   ??????????????????????????????????????????????????????

7. Navigation zurück zu ModulView
   - Status-Badge zeigt: "Änderung" (Rot)
   - Ersteller kann Modul wieder bearbeiten
```

---

## ?? **BENACHRICHTIGUNGS-TEXTE**

### **Einreichung Dozent ? Koordination:**
```
"{Dozent-Name} hat das Modul '{Modulname}' (Version {X.X}) zur Prüfung eingereicht."
```

### **Weiterleitung Koordination ? Gremium:**
```
"{Koordination-Name} (Koordination) hat das Modul '{Modulname}' (Version {X.X}) zur finalen Genehmigung weitergeleitet."
```

### **Freigabe Gremium:**
```
"Glückwunsch! Ihr Modul '{Modulname}' (Version {X.X}) wurde vom Gremium freigegeben und ist jetzt offiziell veröffentlicht."
```

### **Kommentierung Koordination:**
```
"{Koordination-Name} (Koordination) hat Ihr Modul '{Modulname}' kommentiert. Bitte überarbeiten Sie das Modul entsprechend der Kommentare. (Status: InPruefungKoordination ? Änderungsbedarf)"
```

### **Kommentierung Gremium:**
```
"{Gremium-Name} (Gremium) hat Ihr Modul '{Modulname}' kommentiert. Bitte überarbeiten Sie das Modul entsprechend der Kommentare. (Status: InPruefungGremium ? Änderungsbedarf)"
```

---

## ?? **BUTTON-BESCHRIFTUNGEN (KONTEXT-SENSITIV)**

### **"Einreichen" Button - Text ändert sich je nach Rolle:**

| Rolle | Aktueller Status | Button-Text | Aktion |
|-------|-----------------|-------------|--------|
| Dozent | Entwurf | "Einreichen" | ? InPruefungKoordination |
| Dozent | Änderungsbedarf | "Einreichen" | ? InPruefungKoordination |
| Koordination | InPruefungKoordination | "Einreichen" | ? InPruefungGremium |
| Gremium | InPruefungGremium | "Einreichen" | ? Freigegeben |
| Admin | Beliebig | "Einreichen" | Kontext-abhängig |

**Hinweis:** Der Button zeigt immer "Einreichen", aber die Dialoge erklären die jeweilige Aktion.

---

## ?? **TEST-SZENARIEN**

### **Test 1: Vollständiger Durchlauf (Happy Path)**

```
1. Login als Dozent "Hans"
2. Erstelle neues Modul "Test-Modul"
   ? Status: Entwurf

3. Klicke "Einreichen"
   ? Dialog: "Zur Koordination einreichen?"
   ? Klicke "Ja"
   ? Status: InPruefungKoordination
   ? Benachrichtigung an Koordination

4. Login als Koordination
5. "Meine Projekte" zeigt: "Test-Modul"
6. Öffne "Test-Modul"
7. Klicke "Einreichen"
   ? Dialog: "An Gremium weiterleiten?"
   ? Klicke "Ja"
   ? Status: InPruefungGremium
   ? Benachrichtigung an Gremium

8. Login als Gremium
9. "Meine Projekte" zeigt: "Test-Modul"
10. Öffne "Test-Modul"
11. Klicke "Einreichen"
    ? Dialog: "Wirklich freigeben?"
    ? Klicke "Ja"
    ? Status: Freigegeben
    ? Benachrichtigung an Hans

12. Login als Gast
13. StartPage zeigt: "Test-Modul" (jetzt sichtbar!)
```

### **Test 2: Kommentierung durch Koordination**

```
1. Modul ist InPruefungKoordination
2. Login als Koordination
3. Öffne Modul
4. Klicke "Kommentieren"
5. Gebe 2 Kommentare ein
6. Klicke "Kommentar Abschicken"
   ? Dialog: "Kommentar an Ersteller senden? Status ? Änderungsbedarf"
   ? Klicke "Ja"
   ? Status: Änderungsbedarf
   ? Benachrichtigung an Ersteller

7. Login als Dozent (Ersteller)
8. Öffne Modul
   ? Status-Badge: Rot "Änderung"
   ? Button "Bearbeiten": AKTIV
9. Klicke "Bearbeiten"
   ? EditWithCommentsView öffnet sich
   ? Kommentare werden angezeigt
```

### **Test 3: Ungültiger Statuswechsel**

```
1. Modul ist Freigegeben
2. Login als Dozent (Ersteller)
3. Öffne Modul
4. Klicke "Einreichen"
   ? Button ist AUSGEGRAUT (korrekt!)
   
ODER (falls Button aus Versehen aktiv):
   ? Dialog: "Nur Module mit Status 'Entwurf' können eingereicht werden"
```

---

## ? **IMPLEMENTIERTE FEATURES**

### **? Status-Workflow:**
- Entwurf ? InPruefungKoordination ?
- InPruefungKoordination ? InPruefungGremium ?
- InPruefungGremium ? Freigegeben ?
- InPruefungKoordination ? Änderungsbedarf (Kommentar) ?
- InPruefungGremium ? Änderungsbedarf (Kommentar) ?

### **? Bestätigungs-Dialoge:**
- Vor Einreichung ?
- Vor Weiterleitung ?
- Vor Freigabe ?
- Vor Kommentierung ?

### **? Erfolgs-Meldungen:**
- Nach Einreichung ?
- Nach Weiterleitung ?
- Nach Freigabe ?
- Nach Kommentierung ?

### **? Benachrichtigungen:**
- An Koordination bei Einreichung ?
- An Gremium bei Weiterleitung ?
- An Ersteller bei Freigabe ?
- An Ersteller bei Kommentierung ?

### **? UI-Updates:**
- Status-Badge aktualisiert sich ?
- Buttons aktualisieren sich ?
- "Meine Projekte" aktualisiert sich ?

---

## ?? **TECHNISCHE DETAILS**

### **Code-Struktur:**

```csharp
// ModulView.xaml.cs - ModulversionEinreichen_Click()
switch (rolle)
{
    case "Dozent":
        // Entwurf ? InPruefungKoordination
        version.ModulStatus = ModulVersion.Status.InPruefungKoordination;
        BenachrichtigungsService.SendeBenachrichtigung("Koordination", ...);
        break;

    case "Koordination":
        // InPruefungKoordination ? InPruefungGremium
        version.ModulStatus = ModulVersion.Status.InPruefungGremium;
        BenachrichtigungsService.SendeBenachrichtigung("Gremium", ...);
        break;

    case "Gremium":
        // InPruefungGremium ? Freigegeben
        version.ModulStatus = ModulVersion.Status.Freigegeben;
        BenachrichtigungsService.SendeBenachrichtigung(version.Ersteller, ...);
        break;
}
```

```csharp
// CommentView.xaml.cs - KommentarAbschicken_Click()
// Bei JEDER Kommentierung:
modulVersion.ModulStatus = ModulVersion.Status.Aenderungsbedarf;
BenachrichtigungsService.SendeBenachrichtigung(
    modulVersion.Ersteller,
    $"{currentUser} hat Ihr Modul kommentiert...",
    modulVersion.ModulVersionID
);
```

---

Erstellt: 2024
Letzte Aktualisierung: 2024
